# [发布订阅模式 Publisher-Subscriber](https://juejin.im/post/5cd81a20e51d453b4558d858#heading-0)

![publisher](/img/publisher.png)
![publisher](/img/publisher1.png)


在发布-订阅模式，消息的发送方，叫做发布者（publishers），消息不会直接发送给特定的接收者，叫做订阅者（Subscriber）。

发布者和订阅者不知道对方的存在。发布/订阅模式使用一个事件通道，这个通道介于订阅者和发布者之间，采用事件通道可以避免发布者和订阅者之间产生依赖关系。

发布-订阅模式大多数时候是异步的（使用消息队列）。


### 核心
>
    比如我【订阅者】现在订阅了一个公众号，公众号【发布者】向我发布消息

### 案例
```js
let Event = (function () {
  let events = {} //保存订阅主题
  function on(evt, fn) { //订阅
    // 使用'或'是为了可以对同一个事件多次进行回调
    events[evt] = events[evt] || []
    events[evt].push(fn)
  }

  function emit(evt, args) { // 发布
    if (!events[evt]) {
      // 如果未监听任何事件，直接中断
      throw new Error(evt + '事件未监听')
      return
    }
    events[evt].forEach((item)=>{
        // 遍历，实现对同一个事件的多次回调
      item(args) //通知订阅者
    })
  }

  function off(evt) { //取消订阅
    delete events[evt]
  }

  return {
    on,
    emit,
    off
  }
})()

var number = 1;
Event.on('event1', function (data) {
  console.log(data + number++ + '次');
});
Event.on('event1', function (data) {
  console.log(data + number++ + '次');
});
Event.on('event2', function (data) {
  console.log(data);
});
// Event.off('event1'); //  取消绑定


Event.emit('event1', 'event1 事件绑定');
Event.emit('event2', 'event2 事件绑定');

```